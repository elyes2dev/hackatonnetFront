<div class="reset-password-container">
  <div class="card">
    <div class="card-header">
      <h3>Reset Password</h3>
    </div>
    <div class="card-body">

      <!-- Error message -->
      <div *ngIf="errorMessage" class="alert alert-danger">
        {{ errorMessage }}
      </div>

      <!-- Success message -->
      <div *ngIf="successMessage" class="alert alert-success">
        {{ successMessage }}
      </div>

      <!-- Reset Form -->
      <form [formGroup]="resetForm" (ngSubmit)="onSubmit()" *ngIf="!successMessage">
        
        <!-- New Password Field -->
        <div class="form-group">
          <label for="password">New Password</label>
          <input 
            type="password" 
            id="password" 
            formControlName="password" 
            class="form-control"
            [ngClass]="{'is-invalid': password.invalid && password.touched}"
            (input)="checkPasswordsMatch()"
          >
          <div class="invalid-feedback" *ngIf="password.errors?.['required'] && password.touched">
            Password is required
          </div>
          <div class="invalid-feedback" *ngIf="password.errors?.['minlength'] && password.touched">
            Password must be at least 8 characters
          </div>
        </div>

        <!-- Confirm Password Field -->
        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <input 
            type="password" 
            id="confirmPassword" 
            formControlName="confirmPassword" 
            class="form-control"
            [ngClass]="{
              'is-invalid': 
                (!passwordsMatching || confirmPassword.invalid) && confirmPassword.touched
            }"
            (input)="checkPasswordsMatch()"
          >
          <div class="invalid-feedback" *ngIf="confirmPassword.errors?.['required'] && confirmPassword.touched">
            Please confirm your password
          </div>
          <div class="invalid-feedback" *ngIf="!passwordsMatching && confirmPassword.touched">
            Passwords do not match
          </div>
        </div>

        <!-- Submit Button -->
        <div class="form-group">
          <button 
            type="submit" 
            class="btn btn-primary w-100" 
            [disabled]="resetForm.invalid || !passwordsMatching || isLoading"
          >
            <span *ngIf="isLoading" class="spinner-border spinner-border-sm mr-1"></span>
            Reset Password
          </button>
        </div>
      </form>

      <!-- Return to login -->
      <div class="text-center mt-3" *ngIf="!successMessage">
        <a routerLink="/login">Return to Login</a>
      </div>
    </div>
  </div>
</div>
