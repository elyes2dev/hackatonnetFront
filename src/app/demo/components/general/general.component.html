<div class="grid">
  <!-- Header -->
  <div class="col-12">
    <div class="card">
      <h4 class="mb-0">Analytics Dashboard</h4>
    </div>
  </div>

  <!-- Hackathon Analytics Section -->
  <div class="col-12">
    <div class="card">
      <h5 class="text-left font-bold text-xl border-bottom-1 border-300 pb-2 mb-3">Hackathon Analytics</h5>
      <div class="grid">
        <!-- Pie Chart for Online vs Onsite -->
        <div class="col-12 lg:col-6">
          <div class="card flex flex-column align-items-center">
            <h6 class="text-left w-full">Hackathon Types Distribution</h6>
            <div class="flex justify-content-center align-items-center">
              <p-chart type="pie" [data]="pieData" [options]="pieOptions" [style]="{'width': '100%', 'height': '300px'}"></p-chart>
            </div>
            <div class="mt-3 text-center">
              <div class="flex justify-content-center">
                <div class="mr-5">
                  <span class="font-bold">Online:</span> {{onlineCount}}
                </div>
                <div>
                  <span class="font-bold">Onsite:</span> {{onsiteCount}}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Bar Chart for Monthly Distribution -->
        <div class="col-12 lg:col-6">
          <div class="card">
            <h6 class="text-left w-full">Monthly Hackathon Distribution</h6>
            <p-chart type="bar" [data]="barData" [options]="barOptions" [style]="{'width': '100%', 'height': '300px'}"></p-chart>
          </div>
        </div>

        <app-hackathon-categorization-analytics class="col-12"></app-hackathon-categorization-analytics>

        <!-- Line Chart for Cumulative Growth -->
        <div class="col-12">
          <div class="card">
            <h6 class="text-left w-full">Cumulative Hackathon Growth</h6>
            <p-chart type="line" [data]="lineData" [options]="lineOptions" [style]="{'width': '100%', 'height': '300px'}"></p-chart>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Mentor Analytics Section -->
  <div class="col-12">
    <div class="card">
      <h5 class="text-left font-bold text-xl border-bottom-1 border-300 pb-2 mb-3">Mentor Analytics</h5>
      
      <div class="grid">
        <!-- Mentor Badge Distribution -->
        <div class="col-12 lg:col-6">
          <div class="card">
            <h6 class="text-left w-full">Mentor Badge Distribution</h6>
            <p-chart type="pie" [data]="mentorPieData" [options]="mentorPieOptions" [style]="{'width': '100%', 'height': '300px'}"></p-chart>
          </div>
        </div>

        <!-- Top Mentors by Points -->
        <div class="col-12 lg:col-6">
          <div class="card">
            <h6 class="text-left w-full">Top 10 Mentors by Points</h6>
            <div class="overflow-y-auto" style="max-height: 300px">
              <table class="w-full border-collapse">
                <thead>
                  <tr class="border-bottom-1 border-300 text-700">
                    <th class="text-left py-3 px-2">Rank</th>
                    <th class="text-left py-3 px-2">Name</th>
                    <th class="text-right py-3 px-2">Mentor Points</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let mentor of topMentors; let i = index" class="border-bottom-1 border-300">
                    <td class="text-left py-3 px-2">{{i + 1}}</td>
                    <td class="text-left py-3 px-2">{{mentor.name}} {{mentor.lastname}}</td>
                    <td class="text-right py-3 px-2 font-bold">{{mentor.mentorPoints || 0}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Mentor Evaluations -->
        <div class="col-12">
          <div class="card">
            <div class="flex justify-content-between align-items-center mb-3">
              <h6 class="text-left w-full m-0">Mentor Evaluation Ratings</h6>
              <div class="flex">
                <button pButton 
                type="button" 
                label="Best" 
                class="p-button-outlined" 
                [class.p-button-raised]="evaluationFilter === 'best'"
                [class.p-button-outlined]="evaluationFilter !== 'best'"
                (click)="evaluationFilter = 'best'">
            </button>
            
            <button pButton 
                type="button" 
                label="Worst" 
                class="p-button-outlined" 
                [class.p-button-raised]="evaluationFilter === 'worst'"
                [class.p-button-outlined]="evaluationFilter !== 'worst'"
                (click)="evaluationFilter = 'worst'">
            </button>
            </div>
            <p-chart type="bar" [data]="mentorRatingData" [options]="mentorRatingOptions" [style]="{'width': '100%', 'height': '300px'}"></p-chart>
          </div>
        </div>

        <!-- Most Active Mentors -->
        <div class="col-12">
          <div class="card">
            <h6 class="text-left w-full">Most Active Mentors</h6>
            <div class="grid">
              <!-- Monthly Active -->
              <div class="col-12 md:col-4">
                <div class="card">
                  <h6 class="text-center">This Month</h6>
                  <div class="overflow-y-auto" style="max-height: 250px">
                    <ul class="list-none p-0 m-0">
                      <li *ngFor="let mentor of activeTimeframes.month; let i = index" class="flex justify-content-between align-items-center p-3 border-bottom-1 border-300">
                        <div>
                          <span class="font-bold mr-2">{{i + 1}}.</span>
                          <span>{{mentor.name}} {{mentor.lastname}}</span>
                        </div>
                        <p-badge [value]="getMentorHackathonsCount(mentor.hackathonsJoined)" severity="info"></p-badge>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              
              <!-- Half Year Active -->
              <div class="col-12 md:col-4">
                <div class="card">
                  <h6 class="text-center">Last 6 Months</h6>
                  <div class="overflow-y-auto" style="max-height: 250px">
                    <ul class="list-none p-0 m-0">
                      <li *ngFor="let mentor of activeTimeframes.halfYear; let i = index" class="flex justify-content-between align-items-center p-3 border-bottom-1 border-300">
                        <div>
                          <span class="font-bold mr-2">{{i + 1}}.</span>
                          <span>{{mentor.name}} {{mentor.lastname}}</span>
                        </div>
                        <p-badge [value]="(mentor.hackathonsJoined || 0).toString()" severity="info"></p-badge>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              
              <!-- Yearly Active -->
              <div class="col-12 md:col-4">
                <div class="card">
                  <h6 class="text-center">This Year</h6>
                  <div class="overflow-y-auto" style="max-height: 250px">
                    <ul class="list-none p-0 m-0">
                      <li *ngFor="let mentor of activeTimeframes.year; let i = index" class="flex justify-content-between align-items-center p-3 border-bottom-1 border-300">
                        <div>
                          <span class="font-bold mr-2">{{i + 1}}.</span>
                          <span>{{mentor.name}} {{mentor.lastname}}</span>
                        </div>
                        <p-badge [value]="(mentor.hackathonsJoined || 0).toString()" severity="info"></p-badge>                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Mentor Activity by Timeframe -->
        <div class="col-12">
          <div class="card">
            <h6 class="text-left w-full">Mentor Participation in Hackathons</h6>
            <p-chart type="bar" [data]="mentorBarData" [options]="mentorBarOptions" [style]="{'width': '100%', 'height': '300px'}"></p-chart>
          </div>
        </div>
        
        <!-- Mentor Badge Breakdown -->
        <div class="col-12">
          <div class="card">
            <h6 class="text-left w-full">Mentor Badge Breakdown</h6>
            <div class="grid">
              <div class="col-12 md:col-4 lg:col-2" *ngFor="let badge of ['JUNIOR_COACH', 'ASSISTANT_COACH', 'SENIOR_COACH', 'HEAD_COACH', 'MASTER_MENTOR']; let i = index">
                <div class="card shadow-2 text-center p-4 surface-card">
                  <div class="text-900 text-xl mb-2">{{badge.replace('_', ' ')}}</div>
                  <div class="text-600">Count</div>
                  <div class="text-3xl font-bold mt-2">{{badgeCounts[badge]}}</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>